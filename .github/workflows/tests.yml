name: ðŸ§ª Tests

on:
    push:
        branches:
            - main
            - develop
    pull_request:
        branches:
            - main
            - develop

permissions:
    contents: read

jobs:
    test-package-tests:
        name: Test Package Workflows
        uses: ./.github/workflows/package-tests.yml
        with:
            dotnet-tests: '["sandbox/ConsoleApplication"]'
            global-json-file: sandbox/ConsoleApplication/global.json

    test-godot-project-tests:
        name: Test Godot Project
        uses: ./.github/workflows/project-tests.yml
        with:
            godot-projects: '["sandbox/GodotApplication"]'
            global-json-file: sandbox/GodotApplication/global.json

    test-unity-project-tests:
        name: Test Unity Project
        uses: ./.github/workflows/project-tests.yml
        with:
            unity-projects: '["sandbox/UnityApplication"]'
            global-json-file: sandbox/UnityApplication/global.json

    test-package-format:
        name: Test Package Format
        uses: ./.github/workflows/package-format.yml
        with:
            dotnet-projects: '["sandbox/ConsoleApplication", "sandbox/GodotApplication"]'
            global-json-file: sandbox/ConsoleApplication/global.json

    test-project-format:
        name: Test Godot Project Format
        uses: ./.github/workflows/project-format.yml
        with:
            dotnet-projects: '["sandbox/ConsoleApplication"]'
            global-json-file: sandbox/ConsoleApplication/global.json

    test-release-package-dotnet:
        name: Test Release Package - .NET
        uses: ./.github/workflows/package-release.yml
        with:
            name: Test Package
            version-type: patch
            dotnet-projects: '["sandbox/ConsoleApplication"]'
            global-json-file: sandbox/ConsoleApplication/global.json
            publish-github: false
            publish-nuget: false
            publish-discord: false
        secrets:
            github-token: ${{ secrets.GITHUB_TOKEN }}

    test-release-package-godot:
        name: Test Release Package - Godot
        uses: ./.github/workflows/package-release.yml
        with:
            name: Test Package
            version-type: patch
            godot-addons: '["sandbox/GodotApplication/addons/TestAddon"]'
            publish-github: false
            publish-nuget: false
            publish-discord: false
        secrets:
            github-token: ${{ secrets.GITHUB_TOKEN }}

    test-release-package-unity:
        name: Test Release Package - Unity
        uses: ./.github/workflows/package-release.yml
        with:
            name: Test Package
            version-type: patch
            unity-packages: '["sandbox/UnityApplication/Packages/com.test.package"]'
            publish-github: false
            publish-nuget: false
            publish-discord: false
        secrets:
            github-token: ${{ secrets.GITHUB_TOKEN }}

    test-release-package-combined:
        name: Test Release Package - Combined
        uses: ./.github/workflows/package-release.yml
        with:
            name: Test Package
            version-type: patch
            dotnet-projects: '["sandbox/ConsoleApplication"]'
            godot-addons: '["sandbox/GodotApplication/addons/TestAddon"]'
            unity-packages: '["sandbox/UnityApplication/Packages/com.test.package"]'
            global-json-file: sandbox/ConsoleApplication/global.json
            publish-github: false
            publish-nuget: false
            publish-discord: false
        secrets:
            github-token: ${{ secrets.GITHUB_TOKEN }}

    test-release-project-godot:
        name: Test Release Project - Godot
        uses: ./.github/workflows/project-release.yml
        with:
            name: Test Project
            version-type: patch
            environment: Development
            godot-projects: '["sandbox/GodotApplication"]'
            global-json-file: sandbox/GodotApplication/global.json
            release-android: true
            release-ios: false
            publish-github: false
            publish-firebase: false
            publish-testflight: false
            publish-discord: false
        secrets:
            github-token: ${{ secrets.GITHUB_TOKEN }}

    test-release-project-unity:
        name: Test Release Project - Unity
        uses: ./.github/workflows/project-release.yml
        with:
            name: Test Project
            version-type: patch
            environment: Development
            unity-projects: '["sandbox/UnityApplication"]'
            release-android: true
            release-ios: false
            publish-github: false
            publish-firebase: false
            publish-testflight: false
            publish-discord: false
        secrets:
            github-token: ${{ secrets.GITHUB_TOKEN }}

    test-release-project-combined:
        name: Test Release Project - Combined
        uses: ./.github/workflows/project-release.yml
        with:
            name: Test Project
            version-type: patch
            environment: Development
            godot-projects: '["sandbox/GodotApplication"]'
            unity-projects: '["sandbox/UnityApplication"]'
            global-json-file: sandbox/GodotApplication/global.json
            release-android: true
            release-ios: false
            publish-github: false
            publish-firebase: false
            publish-testflight: false
            publish-discord: false
        secrets:
            github-token: ${{ secrets.GITHUB_TOKEN }}
